import{c as B,bq as O,K as $,y as I,r,J as W,L as z,au as D,br as y,aB as N,k as h,w as j,l as k,m as A,n as c,I as K,G as x,aR as q,q as n,O as S,al as E,H as s,N as i,V as G,P as H,Q as M,R as F,U as P,aM as J,a5 as _,T as Q,az as X,bs as Y,W as Z,bt as ee,F as ae,bu as te,_ as se}from"./index-CFJssc1J.js";const le={class:"w-full h-full"},oe=["src"],ne={class:"flex items-center justify-between"},ie=B({__name:"IFrame",props:{widget:{}},setup(U){O(e=>({"9655f970":C.value}));const L=$(),u=I(),m=r(),t=W(U).widget,g=r(!1),f=r(0),o=r(t.value.options.source),d=r(!1),p=r(""),v=e=>te(e)?!0:"URL is not valid.",w=()=>{const e=v(o.value);if(e!==!0){p.value=`${e} Please enter a valid URL.`,d.value=!0;return}t.value.options.source=o.value,p.value=`IFrame URL sucessfully updated to '${o.value}'.`,d.value=!0};z(()=>{window.addEventListener("message",e=>{if(e.data.type!=="cockpit:listenToDatalakeVariables")return;const{variable:a}=e.data;console.log("asked to listen to ",a),D(a,l=>{m.value.contentWindow.postMessage({type:"cockpit:datalakeVariable",variable:a,value:l},"*")})},!1),Object.keys(t.value.options).length===0&&(t.value.options={source:y},o.value=y)});const{width:V,height:b}=N(),R=h(()=>{let e="";return e=e.concat(" ","position: absolute;"),e=e.concat(" ",`left: ${t.value.position.x*V.value}px;`),e=e.concat(" ",`top: ${t.value.position.y*b.value}px;`),e=e.concat(" ",`width: ${t.value.size.width*V.value}px;`),e=e.concat(" ",`height: ${t.value.size.height*b.value}px;`),u.editingMode&&(e=e.concat(" ","pointer-events:none; border:0;")),u.isWidgetVisible(t.value)||(e=e.concat(" ","display: none;")),e}),C=h(()=>(100-f.value)/100);function T(){console.log("Finished loading"),g.value=!0}return j(t,()=>{u.widgetManagerVars(t.value.hash).configMenuOpen===!1&&v(o.value)!==!0&&(o.value=t.value.options.source)},{deep:!0}),(e,a)=>(k(),A(ae,null,[c("div",le,[(k(),K(E,{to:".widgets-view"},[x(c("iframe",{ref_key:"iframe",ref:m,src:n(t).options.source,style:S(R.value),frameborder:"0",onLoad:T},null,44,oe),[[q,g.value]])])),s(Z,{modelValue:n(u).widgetManagerVars(n(t).hash).configMenuOpen,"onUpdate:modelValue":a[3]||(a[3]=l=>n(u).widgetManagerVars(n(t).hash).configMenuOpen=l),"min-width":"400","max-width":"35%"},{default:i(()=>[s(G,{class:"pa-2",style:S(n(L).globalGlassMenuStyles)},{default:i(()=>[s(H,{class:"text-center"},{default:i(()=>a[5]||(a[5]=[M("Settings")])),_:1}),s(F,null,{default:i(()=>[a[6]||(a[6]=c("p",null,"Iframe Source",-1)),c("div",ne,[s(P,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=l=>o.value=l),variant:"filled",outlined:"",rules:[v],onKeydown:J(w,["enter"])},null,8,["modelValue","rules"]),x(s(_,{icon:"mdi-check",class:"mx-1 mb-5 bg-[#FFFFFF22]",rounded:"lg",flat:"",onClick:w},null,512),[[Q,"Set",void 0,{bottom:!0}]])])]),_:1}),s(F,null,{default:i(()=>[s(X,{modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=l=>f.value=l),label:"Transparency",color:"white",min:0,max:90},null,8,["modelValue"])]),_:1}),s(Y,{class:"flex justify-end"},{default:i(()=>[s(_,{color:"white",onClick:a[2]||(a[2]=l=>n(u).widgetManagerVars(n(t).hash).configMenuOpen=!1)},{default:i(()=>a[7]||(a[7]=[M(" Close ")])),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])]),s(ee,{"open-snackbar":d.value,message:p.value,duration:3e3,"close-button":!1,"onUpdate:openSnackbar":a[4]||(a[4]=l=>d.value=l)},null,8,["open-snackbar","message"])],64))}}),de=se(ie,[["__scopeId","data-v-73c330ff"]]);export{de as default};
